{"version":3,"file":"htmlmixed.min.js","sources":["../../../../src/codemirror/mode/htmlmixed/htmlmixed.js"],"sourcesContent":["/*eslint-disable*/\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\n\n(function(mod) {\n    if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n      mod(require(\"../../lib/codemirror\"), require(\"../xml/xml\"), require(\"../javascript/javascript\"), require(\"../css/css\"));\n    else if (typeof define == \"function\" && define.amd) // AMD\n      define([\"../../lib/codemirror\", \"../xml/xml\", \"../javascript/javascript\", \"../css/css\"], mod);\n    else // Plain browser env\n      mod(CodeMirror);\n  })(function(CodeMirror) {\n    \"use strict\";\n\n    var defaultTags = {\n      script: [\n        [\"lang\", /(javascript|babel)/i, \"javascript\"],\n        [\"type\", /^(?:text|application)\\/(?:x-)?(?:java|ecma)script$|^module$|^$/i, \"javascript\"],\n        [\"type\", /./, \"text/plain\"],\n        [null, null, \"javascript\"]\n      ],\n      style:  [\n        [\"lang\", /^css$/i, \"css\"],\n        [\"type\", /^(text\\/)?(x-)?(stylesheet|css)$/i, \"css\"],\n        [\"type\", /./, \"text/plain\"],\n        [null, null, \"css\"]\n      ]\n    };\n\n    function maybeBackup(stream, pat, style) {\n      var cur = stream.current(), close = cur.search(pat);\n      if (close > -1) {\n        stream.backUp(cur.length - close);\n      } else if (cur.match(/<\\/?$/)) {\n        stream.backUp(cur.length);\n        if (!stream.match(pat, false)) stream.match(cur);\n      }\n      return style;\n    }\n\n    var attrRegexpCache = {};\n    function getAttrRegexp(attr) {\n      var regexp = attrRegexpCache[attr];\n      if (regexp) return regexp;\n      return attrRegexpCache[attr] = new RegExp(\"\\\\s+\" + attr + \"\\\\s*=\\\\s*('|\\\")?([^'\\\"]+)('|\\\")?\\\\s*\");\n    }\n\n    function getAttrValue(text, attr) {\n      var match = text.match(getAttrRegexp(attr))\n      return match ? /^\\s*(.*?)\\s*$/.exec(match[2])[1] : \"\"\n    }\n\n    function getTagRegexp(tagName, anchored) {\n      return new RegExp((anchored ? \"^\" : \"\") + \"<\\/\\\\s*\" + tagName + \"\\\\s*>\", \"i\");\n    }\n\n    function addTags(from, to) {\n      for (var tag in from) {\n        var dest = to[tag] || (to[tag] = []);\n        var source = from[tag];\n        for (var i = source.length - 1; i >= 0; i--)\n          dest.unshift(source[i])\n      }\n    }\n\n    function findMatchingMode(tagInfo, tagText) {\n      for (var i = 0; i < tagInfo.length; i++) {\n        var spec = tagInfo[i];\n        if (!spec[0] || spec[1].test(getAttrValue(tagText, spec[0]))) return spec[2];\n      }\n    }\n\n    CodeMirror.defineMode(\"htmlmixed\", function (config, parserConfig) {\n      var htmlMode = CodeMirror.getMode(config, {\n        name: \"xml\",\n        htmlMode: true,\n        multilineTagIndentFactor: parserConfig.multilineTagIndentFactor,\n        multilineTagIndentPastTag: parserConfig.multilineTagIndentPastTag,\n        allowMissingTagName: parserConfig.allowMissingTagName,\n      });\n\n      var tags = {};\n      var configTags = parserConfig && parserConfig.tags, configScript = parserConfig && parserConfig.scriptTypes;\n      addTags(defaultTags, tags);\n      if (configTags) addTags(configTags, tags);\n      if (configScript) for (var i = configScript.length - 1; i >= 0; i--)\n        tags.script.unshift([\"type\", configScript[i].matches, configScript[i].mode])\n\n      function html(stream, state) {\n        var style = htmlMode.token(stream, state.htmlState), tag = /\\btag\\b/.test(style), tagName\n        if (tag && !/[<>\\s\\/]/.test(stream.current()) &&\n            (tagName = state.htmlState.tagName && state.htmlState.tagName.toLowerCase()) &&\n            tags.hasOwnProperty(tagName)) {\n          state.inTag = tagName + \" \"\n        } else if (state.inTag && tag && />$/.test(stream.current())) {\n          var inTag = /^([\\S]+) (.*)/.exec(state.inTag)\n          state.inTag = null\n          var modeSpec = stream.current() == \">\" && findMatchingMode(tags[inTag[1]], inTag[2])\n          var mode = CodeMirror.getMode(config, modeSpec)\n          var endTagA = getTagRegexp(inTag[1], true), endTag = getTagRegexp(inTag[1], false);\n          state.token = function (stream, state) {\n            if (stream.match(endTagA, false)) {\n              state.token = html;\n              state.localState = state.localMode = null;\n              return null;\n            }\n            return maybeBackup(stream, endTag, state.localMode.token(stream, state.localState));\n          };\n          state.localMode = mode;\n          state.localState = CodeMirror.startState(mode, htmlMode.indent(state.htmlState, \"\", \"\"));\n        } else if (state.inTag) {\n          state.inTag += stream.current()\n          if (stream.eol()) state.inTag += \" \"\n        }\n        return style;\n      };\n\n      return {\n        startState: function () {\n          var state = CodeMirror.startState(htmlMode);\n          return {token: html, inTag: null, localMode: null, localState: null, htmlState: state};\n        },\n\n        copyState: function (state) {\n          var local;\n          if (state.localState) {\n            local = CodeMirror.copyState(state.localMode, state.localState);\n          }\n          return {token: state.token, inTag: state.inTag,\n                  localMode: state.localMode, localState: local,\n                  htmlState: CodeMirror.copyState(htmlMode, state.htmlState)};\n        },\n\n        token: function (stream, state) {\n          return state.token(stream, state);\n        },\n\n        indent: function (state, textAfter, line) {\n          if (!state.localMode || /^\\s*<\\//.test(textAfter))\n            return htmlMode.indent(state.htmlState, textAfter, line);\n          else if (state.localMode.indent)\n            return state.localMode.indent(state.localState, textAfter, line);\n          else\n            return CodeMirror.Pass;\n        },\n\n        innerMode: function (state) {\n          return {state: state.localState || state.htmlState, mode: state.localMode || htmlMode};\n        }\n      };\n    }, \"xml\", \"javascript\", \"css\");\n\n    CodeMirror.defineMIME(\"text/html\", \"htmlmixed\");\n  });"],"names":["mod","CodeMirror","defaultTags","script","style","attrRegexpCache","getAttrValue","text","attr","match","RegExp","getAttrRegexp","exec","getTagRegexp","tagName","anchored","addTags","from","to","tag","dest","source","i","length","unshift","defineMode","config","parserConfig","htmlMode","getMode","name","multilineTagIndentFactor","multilineTagIndentPastTag","allowMissingTagName","tags","configTags","configScript","scriptTypes","matches","mode","html","stream","state","token","htmlState","test","current","toLowerCase","hasOwnProperty","inTag","modeSpec","tagInfo","tagText","spec","findMatchingMode","endTagA","endTag","localState","localMode","pat","cur","close","search","backUp","maybeBackup","startState","indent","eol","copyState","local","textAfter","line","Pass","innerMode","defineMIME","exports","module","require","define","amd"],"mappings":"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"}